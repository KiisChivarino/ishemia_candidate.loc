{{ form_start(form) }}
{% macro recursiveForm(form) %}
    {% if
        form.vars.multiple is defined and form.vars.multiple
        and form.vars.expanded is defined and form.vars.expanded %}
        <li>
        <span class="title">{{ form_label(form) }}</span>
    {% endif %}
    {% if form.children is empty %}
        {% if form.parent and form.parent.vars.choices is not defined %}
            <li>
        {% endif %}
        {% if 'hidden' not in form.vars.block_prefixes and not form.rendered %}
            <span class="title">{{ form_label(form) }}</span>
            {{ form_widget(form) }}
            <small>{{ form_help(form) }}</small>
            <div class="form-error">
                {{ form_errors(form) }}
            </div>
        {% endif %}
        {% if form.parent and form.parent.vars.choices is not defined %}
            </li>
        {% endif %}
    {% else %}
        {% for key, item in form %}
            {# {% if key != 'patientTestingFiles' %} #}
            {{ _self.recursiveForm(item) }}
            {# {% endif %} #}
        {% endfor %}
    {% endif %}
    {% if
        form.vars.multiple is defined and form.vars.multiple
        and form.vars.expanded is defined and form.vars.expanded %}
        </li>
    {% endif %}
{% endmacro %}
<ul>
    <li>
        <div id="fileBox">
            {% set pos = 0 %}
            <div id="jsFileWidgetExample" style="display: none;">
                {{ form_widget(form.dischargeEpicrisis.dischargeEpicrisisFiles.vars.prototype) }}
            </div>
            {% for doc in form.dischargeEpicrisis.dischargeEpicrisisFiles %}
                <div class="jsFile" data-pos="{{ pos }}">
                    <div id="jsView{{ pos }}">
                        <span id="jsName{{ pos }}">
                            {{ doc.vars.value ? doc.vars.value.fileName : '' }}
                        </span>
                        <span id="jsRemove{{ pos }}">
                            <button type="button" class="js-remove-file">
                                <i class="fa fa-times" aria-hidden="true"></i>
                            </button>
                        </span>
                    </div>
                    <div id="jsWidget{{ pos }}" style="display: none;">
                        {{ form_widget(doc) }}
                    </div>
                </div>
                {% set pos = pos + 1 %}
            {% endfor %}
        </div>
    </li>
    {{ _self.recursiveForm(form) }}
</ul>

<div class="buttons">
    <button class="btn btn--mode">{{ button_label|default(template.items.form.content.formButtonLabel) }}</button>
</div>
{{ form_end(form) }}